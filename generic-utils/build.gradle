sourceSets {
    apt {
        java {
            srcDir 'src/apt/java'
        }
    }
}

task aptJar(type: Jar, dependsOn: classes) {
    classifier = 'apt'
    from sourceSets.apt.output
}

publishing {
    publications {
        mavenJava {
            artifact project.tasks.aptJar
        }
    }
}

dependencies {
    aptImplementation project(':apt-utils')
    aptImplementation project(':stream-utils')
    aptImplementation sourceSets.main.output
    aptImplementation "com.google.auto.service:auto-service:$autoServiceVer"
    aptImplementation "com.google.guava:guava:$guavaVer"
    aptImplementation "com.google.auto.value:auto-value-annotations:$autoValueVer"
    aptImplementation "com.google.auto.value:auto-value:$autoValueVer"
    aptAnnotationProcessor "com.google.auto.value:auto-value:$autoValueVer"
    aptAnnotationProcessor "com.google.auto.service:auto-service:$autoServiceVer"
    testImplementation sourceSets.apt.output
    testImplementation project(path: ':apt-utils', configuration: 'testOutput')
}
