#parse("macros.vm")

    #annotate($annotators.annotateCreator($context))

    public static #typeParamsDeclaration($sourceClass) $targetClass.simpleName()#typeParams($sourceClass) create(
#foreach($p in $properties)
        #annotate($annotators.annotateCreatorParameter($context, $p)) $[$p.type()] $p.name()##
    #if ($foreach.hasNext),##
##

##
    #end##
#end) {
        return ${targetClass.simpleName()}.#typeParams($sourceClass)builder()
#foreach($p in $properties)
            .${p.name()}($p.name())##
##

#end
            .build();
    }

#if ($properties.size() > $mandatoryProperties.size())
    public static #typeParamsDeclaration($sourceClass) $targetClass.simpleName()#typeParams($sourceClass) create(
#foreach($p in $mandatoryProperties)
        $[$p.type()] $p.name()##
    #if ($foreach.hasNext),##
##

##
    #end##
#end) {
        return ${targetClass.simpleName()}.#typeParams($sourceClass)builder()
#foreach($p in $mandatoryProperties)
            .${p.name()}($p.name())##
##

#end
            .build();
    }
#end

    #annotate($annotators.annotateNonPropertyMethod($context))

    public abstract Builder#typeParams($sourceClass) toBuilder();

    public static #typeParamsDeclaration($sourceClass) Builder#typeParams($sourceClass) builder() {
        return Builder.create();
    }

    @$[com.google.auto.value.AutoValue].Builder
    public interface Builder#typeParamsDeclaration($sourceClass) extends ##
            $[com.slimgears.util.autovalue.annotations.BuilderPrototype]<$targetClass.simpleName()#typeParams($sourceClass), ##
            Builder#typeParams($sourceClass)>, ##
            $[${sourceClass.erasureName()}Builder]<##
#foreach ($tp in $sourceClass.typeParams())##
            $[$tp.type()], ##
#end##
            Builder#typeParams($sourceClass)> {##

        public static #typeParamsDeclaration($sourceClass) Builder#typeParams($sourceClass) create() {
            return new AutoValue_${targetClass.simpleName()}.Builder#if ($sourceClass.hasTypeParams())<>#end();
        }
#foreach ($p in $properties)##
##

        @Override##
    #foreach ($a in $p.annotations())##
        #if ($a.type().simpleName() != "Nullable")##
##

            $a.asString()##
        #end##
    #end##
##

        Builder#typeParams($sourceClass) ${p.setterName()}($[$p.type()] $p.name());##
    #if ($p.hasBuilder() && !$p.isOptional())##
##

            $[$p.builderType()] ${p.name()}Builder();##

##
    #end##
    #if ($foreach.hasNext)##

##
    #end##
#end

    }
